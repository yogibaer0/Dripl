<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dripl • Ameba</title>

  <!-- ===== Config (injected by server.ts) ===== -->
  <meta name="supabase-url" content="{{SUPABASE_URL}}">
  <meta name="supabase-anon-key" content="{{SUPABASE_ANON_KEY}}">
  <meta name="api-base" content="{{API_BASE}}">
  <meta name="page-nonce" content="{{NONCE}}">

  <!-- ===== Styles ===== -->
  <link rel="stylesheet" href="/styles.css" />

  <!-- ===== Security: CSP nonced UMD & app ===== -->
  <!-- Local UMD to avoid CDN/CSP headaches.  'SUPABASE_SRI_ATTR' is injected if you supplied an SRI hash. -->
  <script {{SUPABASE_SRI_ATTR}} src="/vendor/supabase.min.js" nonce="{{NONCE}}"></script>

  <!-- Small bootstrap that exposes config + nonce to script.js -->
  <script nonce="{{NONCE}}">
    (function () {
      const meta = (n) => document.querySelector(`meta[name="${n}"]`)?.content?.trim() || "";
      window.__APP__ = {
        NONCE:    meta("page-nonce"),
        API_BASE: meta("api-base") || "",
        SUPABASE_URL: meta("supabase-url"),
        SUPABASE_ANON_KEY: meta("supabase-anon-key")
      };
    }());
  </script>
</head>

<body>
  <header class="site-header">
    <h1>Dripl</h1>
    <div class="hr"></div>
  </header>

  <main class="grid">
    <!-- ============ Upload ============ -->
    <section class="panel" id="upload">
      <h2>Upload</h2>
      <div id="dropzone" class="dropzone" aria-label="Drag & drop files here">
        <p>Drag &amp; drop files here… <em>or</em> drop a link / text</p>
      </div>

      <div class="row">
        <input id="paste-input" class="input" placeholder="Paste link (YouTube, TikTok, …)" />
        <select id="format" class="select">
          <option value="mp4">MP4 (video)</option>
          <option value="mp3">MP3 (audio)</option>
          <option value="gif">GIF</option>
        </select>
        <button id="convert-btn" class="btn">Convert</button>
      </div>

      <p class="hint">Pro tip: press <kbd>Enter</kbd> to convert instantly.</p>
    </section>

    <!-- ============ Import ============ -->
    <section class="panel" id="import">
      <h2>Import</h2>

      <div class="card">
        <h3>This device</h3>
        <input id="pick-files" type="file" multiple />
      </div>

      <div class="card">
        <h3>Dropbox</h3>
        <button class="btn secondary" id="btn-dropbox">Connect Dropbox</button>
        <p class="muted">Direct links, multi-select</p>
      </div>

      <div class="card">
        <h3>Google Drive</h3>
        <button class="btn secondary" id="btn-gdrive">Connect Google Drive</button>
        <p class="muted">Picker with OAuth</p>
      </div>
    </section>

    <!-- ============ Storage ============ -->
    <section class="panel" id="storage">
      <h2>Storage</h2>
      <div class="row">
        <button class="btn secondary">+ Folder</button>
        <button class="btn secondary">Filters</button>
        <button class="btn secondary">Presets</button>
      </div>
      <input id="storage-search" class="input" placeholder="Search by file name, tags, notes…" />
      <div class="chips">
        <button class="chip active">Recent</button>
        <button class="chip">Saved ★</button>
        <button class="chip">In progress</button>
        <button class="chip">Shared with me</button>
        <button class="chip">Trash</button>
      </div>
      <ul id="storage-list" class="list"></ul>
    </section>
  </main>

  <!-- ============ Destination Hub ============ -->
  <section class="panel wide" id="dest-hub">
    <h2>Destination Hub</h2>

    <div class="dest-grid">
      <!-- Preview -->
      <div class="preview">
        <div class="thumb" id="preview-thumb" aria-label="Preview thumbnail"></div>
        <dl class="meta" id="preview-meta">
          <div><dt>Filename</dt><dd id="meta-name">—</dd></div>
          <div><dt>Duration</dt><dd id="meta-duration">—</dd></div>
          <div><dt>Resolution</dt><dd id="meta-res">—</dd></div>
          <div><dt>Codec</dt><dd id="meta-codec">—</dd></div>
        </dl>
      </div>

      <!-- Presets -->
      <div class="presets">
        <h3>One-click formats</h3>
        <div class="preset-row">
          <button class="btn preset" data-preset="tiktok">TikTok</button>
          <button class="btn preset" data-preset="instagram">Instagram</button>
          <button class="btn preset" data-preset="youtube">YouTube</button>
          <button class="btn preset" data-preset="reddit">Reddit</button>
          <button class="btn preset" data-preset="twitter">Twitter (X)</button>
        </div>

        <div class="row">
          <label class="switch">
            <input type="checkbox" id="opt-watermark" />
            <span>Watermark</span>
          </label>
          <label class="switch">
            <input type="checkbox" id="opt-trim" />
            <span>Auto-trim to platform max</span>
          </label>
        </div>

        <div class="row">
          <button id="start-convert" class="btn primary">Convert Selected</button>
          <span id="job-status" class="muted"></span>
        </div>
      </div>
    </div>
  </section>

  <!-- App logic (non-module; nonce for CSP) -->
  <script src="/script.js" nonce="{{NONCE}}"></script>
</body>
</html>




















